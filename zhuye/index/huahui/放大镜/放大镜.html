<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>放大镜</title>
    <style>
        *{
            padding: 0;
            margin: 0;
            list-style: none;
            box-sizing: border-box;
        }
        .box1{
            width: 300px;
            height: 300px;
            border: 1px solid #000;
            float: left;
            margin: 100px 20px 0 400px;
            position: relative;
            cursor: move;
        }
        img{
            display: block;
            width: 100%;
            height: 100%;
        }
        .pointer{
            width: 100px;
            height: 100px;
            /*background: rgba(0,0,0,0.5);*/
            background-image: url("data:image/gif;base64,R0lGODlhCwALAJECAM7Lzv///////wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4zLWMwMTEgNjYuMTQ1NjYxLCAyMDEyLzAyLzA2LTE0OjU2OjI3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOkFERDZFOTU0OTdEMTExRTU5OUEwOUI4MTEyQUM5QkQxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjE2OEE0MkRBOTdENDExRTVCM0Y0RUU5QTQ1OUJEODA4IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjE2OEE0MkQ5OTdENDExRTVCM0Y0RUU5QTQ1OUJEODA4IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MEMyNERBMDhEMzk3RTUxMUFFRTBCREQ4QzU2QjU2OTciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QURENkU5NTQ5N0QxMTFFNTk5QTA5QjgxMTJBQzlCRDEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQBAAACACwAAAAACwALAAACGpQNpxi5AoJ0J8pZr05WX+5hzLZ0lBKd5VIAADs=");
            background-repeat: repeat;
            position: absolute;
            top: 0;
            left: 0;
            display: none;
        }
        .box2{
            width: 300px;
            height: 300px;
            border: 1px solid #000;
            float: left;
            margin: 100px 0 0 0;
            position: relative;
            overflow: hidden;
        }
        .opcity{
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 999;
        }
        .box2 img{
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
<div class="box1">
    <div class="opcity"></div>
    <img src="https://i1.mifile.cn/f/i/g/2015/cn-index/note5-320-220.png" alt="">
    <div class="pointer"></div>
</div>
<div class="box2">
    <img src="https://i1.mifile.cn/f/i/g/2015/cn-index/note5-320-220.png" alt="">
</div>
</body>
</html>
<script src="./jquery-3.3.1.js"></script>
<script>
    $(".box1").mouseover(function () {
        $(".pointer").show();
        });
    $(".box1").mouseout(function () {
        $(".pointer").hide();
    });
    let maxwidth=$(".box1").innerWidth()-$(".pointer").width();
    let maxheight=$(".box1").innerHeight()-$(".pointer").height();
    //1.遮罩跟着鼠标移动
    $(".box1").mousemove(function (e) {
        let mx=e.offsetX-50;
        let my=e.offsetY-50;
        if (mx>=maxwidth){
            mx=maxwidth;
        }
        if(mx<0){
            mx=0;
        }
        if(my>=maxheight){
            my=maxheight;
        }
        if (my<0){
            my=0;
        }
        $(".pointer").css({'left':mx+"px",'top':my+"px"});
        //2.右侧图片方法和位置移动
        let scales=5;
        let widths=$(".box2").width();
        let heights=$(".box2").height();
        $(".box2 img").css({"width":widths*scales+"px","height":heights*scales+"px",'left':-scales*mx+"px",'top':-scales*my+"px"})
    });
    // $(".box1").mousedown(function (e) {
    //     let oldx=e.offsetX;
    //     let oldy=e.offsetY;
    //     $(".box1").mousemove(function (e) {
    //         let newx=e.offsetX;
    //         let newy=e.offsetY;
    //         let mx=newx-oldx;
    //         let my=newy-oldy;
    //         $(".pointer").css({'left':mx+"px",'top':my+"px"});
    //     })
    //     // $(".box1".mouseup(function () {
    //     //
    //     // }))
    // })
    $(".pointer").on('mousedown',function (e) {
        let oldx=e.offsetX
    })
</script>